<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="index.fld/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Microsoft Office User</o:Author>
  <o:LastAuthor>Microsoft Office User</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:Created>2025-07-23T00:49:00Z</o:Created>
  <o:LastSaved>2025-07-23T00:50:00Z</o:LastSaved>
  <o:Pages>48</o:Pages>
  <o:Words>13825</o:Words>
  <o:Characters>76038</o:Characters>
  <o:Lines>633</o:Lines>
  <o:Paragraphs>179</o:Paragraphs>
  <o:CharactersWithSpaces>89684</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="index.fld/themedata.thmx">
<link rel=colorSchemeMapping href="index.fld/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>ES-CO</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="375">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536859905 -1073732485 9 0 511 0;}
@font-face
	{font-family:"Apple Color Emoji";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 402653184 335544320 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 3.0cm 70.85pt 3.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Tabla normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
</style>
<![endif]-->
</head>

<body lang=ES-CO style='tab-interval:35.4pt'>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;!DOCTYPE
html&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;html
lang=&quot;es&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'>&lt;head&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&lt;meta charset=&quot;UTF-8&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span>&lt;meta name=&quot;viewport&quot;
content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>&lt;title&gt;Bloque Armónico Pro:
Herramienta de Entrenamiento&lt;/title&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;!-- Tone.js
para la reproducción de audio --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span lang=EN-US
style='mso-ansi-language:EN-US'>&lt;script
src=&quot;https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>    </span></span>&lt;style&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Ajustes de
HTML y Body para evitar el desplazamiento */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>html, body {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
100%; /* El html y el body ocupan toda la altura del viewport */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>margin: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>overflow:
hidden; /* Oculta cualquier contenido que se desborde para evitar el
desplazamiento */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex; /* Convierte el body en un contenedor flex */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>flex-direction: column; /* Apila los elementos hijos verticalmente */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center; /* Centra el contenido verticalmente */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>align-items: center; /* Centra el contenido horizontalmente */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-sizing: border-box;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos
base para el cuerpo y el contenedor */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>body {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
5px; /* Relleno mínimo para el body */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>font-family: 'Inter', sans-serif;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span></span>background-color: #f0f4f8; /* Fondo
azul gris claro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#334155; /* Color de texto más oscuro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>line-height: 1.6;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.container {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #ffffff;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>padding: 15px; /* Relleno
general reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>padding-bottom: 20px; /* Relleno inferior reducido para el botón */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>border-radius: 12px;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>box-shadow: 0 10px 25px
rgba(0,0,0,0.1);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>max-width: 650px;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span></span>width: 98%; /* Mayor ancho
para mejor responsividad */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>box-sizing: border-box;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>border: 1px solid #e2e8f0;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>flex-direction: column;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>gap: 8px;
/* Espaciado reducido entre secciones */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>flex-grow:
1; /* Permite que el contenedor crezca y ocupe el espacio disponible */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>max-height: 99vh; /* Limita la altura para evitar que se desborde del
body */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>overflow-y: auto; /* Permite el desplazamiento interno si el contenido
excede la altura máxima */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Encabezados
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>h1 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#1e3a8a;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 8px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.8em; /* Fuente ligeramente más pequeña */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>font-weight: 700;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>h2 {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>color: #2563eb;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>margin-top: 5px; /* Margen
reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 8px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.3em; /* Fuente ligeramente más pequeña */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Área de
visualización de la pregunta */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>#questionArea {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #eff6ff;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>padding: 10px; /* Relleno reducido
*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>border-radius: 10px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#1e40af;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>min-height: 60px; /* Altura mínima reducida */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>flex-direction: column;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>align-items: center;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>justify-content: center;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>border: 1px solid #dbeafe;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>gap: 6px;
/* Espaciado reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#questionArea
p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>margin: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.3em; /* Fuente ligeramente más pequeña para el texto de la pregunta */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-weight: 600;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos de
la cuadrícula de notas (para la cuadrícula de la pregunta) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.notes-grid {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
grid;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>grid-template-columns: 1fr; /* Una sola columna para el diseño vertical
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>grid-auto-rows: 1fr; /* Hace que las filas tengan la misma altura */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>gap: 2px;
/* Espaciado aún más pequeño entre celdas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width: 180px;
/* Ancho ajustado para ser más compacto */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>max-width:
180px; /* Ancho fijo para la visualización vertical */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>margin: 0
auto; /* Centra la cuadrícula */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
2px solid #64748b; /* Borde exterior para la cuadrícula */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 5px; /* Esquinas ligeramente redondeadas para el
contenedor de la cuadrícula */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>overflow:
hidden; /* Asegura que los bordes internos sean limpios */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
240px; /* Altura fija ajustada para 4 celdas más compactas y visibles */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.grid-cell {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #ffffff;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>border: 1px solid #94a3b8;
/* Bordes de celda internos */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
12px 10px; /* Relleno ajustado para acomodar la etiqueta y la nota */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: space-between; /* Espacio entre la etiqueta y la nota
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>align-items: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.2em; /* Tamaño de fuente base para las celdas de la cuadrícula */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-weight:
700;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#334155;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-sizing: border-box; /* Incluye el relleno y el borde en el ancho y
alto total del elemento */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.interval-label {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
0.8em; /* Fuente más pequeña para la etiqueta del intervalo */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#64748b; /* Color más claro para la etiqueta */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-weight: normal; /* Peso normal para la etiqueta */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.note-display
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.5em; /* Fuente más grande para la nota */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>font-weight: 700;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>color: #334155;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-display.highlighted {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>background-color: #facc15;
/* Fondo amarillo para la nota resaltada */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>color: #334155; /* Texto más oscuro
para contraste */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
2px 5px; /* Pequeño relleno para el efecto de resaltado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 4px; /* Esquinas redondeadas para el resaltado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Sección de
entrada - Selección de notas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.input-group {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>flex-direction: column;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>gap: 6px; /* Espaciado
reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 15px; /* Margen inferior ajustado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>label {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span>display: block;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>margin-bottom: 2px; /* Margen
reducido */<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>font-weight: 600;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#475569;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Controles
de construcción de notas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.note-building-controls {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>gap: 8px; /* Espaciado
reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 8px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>flex-wrap:
wrap; /* Permite el ajuste en pantallas más pequeñas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>justify-content: center;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>      </span>.natural-note-buttons,
.accidental-buttons {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>display: grid;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>gap: 3px;
/* Espaciado reducido para los botones */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>flex: 1;
/* Permite que crezcan */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>min-width:
110px; /* Ancho mínimo reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.natural-note-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>grid-template-columns: repeat(auto-fit, minmax(30px, 1fr)); /* minmax
ajustado para botones más pequeños */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.accidental-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>grid-template-columns: repeat(2, 1fr); /* 2 columnas para accidentales
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>max-width:
80px; /* Ancho máximo reducido para botones accidentales */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-button {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #e2e8f0; /* Gris
claro */<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>color: #475569;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
6px 0; /* Relleno reducido para botones más pequeños */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #cbd5e1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
0.7em; /* Tamaño de fuente aún más reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>font-weight: 600;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>cursor: pointer;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>transition: background-color 0.2s
ease, transform 0.1s ease;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>user-select: none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>min-width:
30px; /* Ancho mínimo ajustado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-button:hover {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #d1d9e2;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>transform: translateY(-1px);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-button:active {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>transform: translateY(0);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-button.selected {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>background-color: #2563eb;
/* Azul para seleccionado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>color: white;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>border-color: #1e40af;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>box-shadow: 0 2px 5px
rgba(0,0,0,0.2);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.note-button.disabled {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>opacity: 0.6;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>cursor: not-allowed;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #f1f5f9;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>color: #94a3b8;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>/* No longer using active-accidental
class directly, 'selected' will be enough */<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span></span>/* Visualización de la nota
actual en construcción - REMOVED */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/*
#currentBuildingNoteDisplay {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>} */<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Botones
para añadir/limpiar la nota actual - REMOVED */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>/* .button-group-inline {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>display: none;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span></span>} */<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/*
Visualización de las notas seleccionadas (lista de respuesta final) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>#selectedNotesDisplay {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>background-color: #eff6ff;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>padding: 10px; /* Relleno reducido
*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>min-height: 30px; /* Altura mínima reducida */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>align-items: center;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>color: #1e40af;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>border: 1px solid #dbeafe;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>font-weight: 500;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>margin-bottom: 8px; /* Margen
reducido */<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>#selectedNotesDisplay strong {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>color: #1d4ed8;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Grupo de
botones de acción principal */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>.action-buttons-group {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>display: flex;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>gap: 10px; /* Espaciado
reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-top: auto; /* Empuja el grupo de botones hacia abajo */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>padding-top: 10px; /* Añade algo de relleno encima de los botones */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.action-buttons-group button {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>padding: 10px 20px; /* Relleno
reducido */<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>border: none;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>border-radius: 8px;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>font-size: 1em; /* Tamaño de
fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
lang=EN-US style='mso-ansi-language:EN-US'>font-weight: 600;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>cursor: pointer;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>transition: background-color 0.3s
ease, transform 0.2s ease, box-shadow 0.2s ease;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span>box-shadow: 0 4px 6px
rgba(0,0,0,0.1);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>        </span>.action-buttons-group button:hover {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>            </span></span>transform: translateY(-2px);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 6px 10px rgba(0,0,0,0.15);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.action-buttons-group button:active {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 2px 4px rgba(0,0,0,0.1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#confirmAnswerButton {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #22c55e; /* Verde */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#confirmAnswerButton:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #16a34a;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#clearAllSelectionButton {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #f59e0b; /* Naranja */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#clearAllSelectionButton:hover
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #d97706;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#changeQuestionButton {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #64748b; /* Gris */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#changeQuestionButton:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>background-color:
#475569;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos de
modal comunes (para feedback y evaluación) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-overlay
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>position:
fixed;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>top: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>left: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: rgba(0, 0, 0, 0.6);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
none; /* Oculto por defecto */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>align-items: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>z-index:
1000;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>opacity:
0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>visibility: hidden;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>transition: opacity 0.3s ease,
visibility 0.3s ease;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.modal-overlay.visible {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex; /* Mostrar cuando es visible */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>opacity:
1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>visibility: visible;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #ffffff;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
25px; /* Relleno reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 12px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 15px 30px rgba(0,0,0,0.2);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>max-width:
450px; /* Ancho máximo reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width: 90%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(-20px);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>transition: transform 0.3s ease;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.modal-overlay.visible .modal-content {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
h3 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#1e3a8a;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.6em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 15px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#475569;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 10px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
ul {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>list-style: none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 15px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: left;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#334155;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
ul li {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>background-color: #eff6ff;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
8px 12px; /* Relleno reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 6px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #dbeafe;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
ul li strong {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#2563eb;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
.modal-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>gap: 10px;
/* Espaciado reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-top: 15px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
.modal-buttons button {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
10px 20px; /* Relleno reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-weight: 600;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>cursor:
pointer;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>transition: background-color 0.3s ease, transform 0.2s ease, box-shadow
0.2s ease;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 4px 6px rgba(0,0,0,0.1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
.modal-buttons button:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(-2px);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 6px 10px rgba(0,0,0,0.15);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.modal-content
.modal-buttons button:active {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 2px 4px rgba(0,0,0,0.1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#continueQuizButton
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #3b82f6; /* Azul */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#continueQuizButton:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #2563eb;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#endQuizButton
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #ef4444; /* Rojo */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#endQuizButton:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #dc2626;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos
específicos del contenido del modal de feedback (usa la base de modal-content)
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#feedbackModalContent.correct {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #dcfce7; /* Verde claro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#15803d; /* Verde oscuro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #15803d;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#feedbackModalContent.incorrect {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'>   </span>background-color: #fee2e2; /* Rojo claro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#b91c1c; /* Rojo oscuro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #b91c1c;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#feedbackModalContent p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>margin:
5px 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#feedbackModalContent strong {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.2em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#feedbackModalContent span {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/*
Visualización del mensaje final */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#finalMessageDisplay {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #d1fae5; /* Verde claro para el éxito */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
25px; /* Relleno reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 12px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 10px 25px rgba(0,0,0,0.1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>max-width:
600px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
none; /* Oculto por defecto */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>flex-direction: column;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>align-items: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>justify-content:
center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>min-height: 180px; /* Altura mínima reducida */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #6ee7b7;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#065f46;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#finalMessageDisplay h3 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#047857;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.8em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 10px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#finalMessageDisplay p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 8px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#finalMessageDisplay
.results-summary {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-weight: bold;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.1em; /* Tamaño de fuente reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-top: 15px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#finalMessageDisplay .email-info {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-style: italic;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#064e3b;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-top: 10px; /* Margen reducido */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos
para la pantalla de inicio */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>position:
fixed;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>top: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>left: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #e2e8f0; /* Un color suave para la intro */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>flex-direction: column;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>align-items:
center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>z-index:
1001; /* Asegura que esté por encima de todo */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>text-align: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
20px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-sizing: border-box;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen
h2 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
2.2em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#1e3a8a;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 15px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen p
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.2em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
#475569;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-bottom: 25px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen
button {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
12px 25px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #2563eb;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>color:
white;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>font-size:
1.1em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>font-weight: 600;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>cursor:
pointer;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>transition: background-color 0.3s ease, transform 0.2s ease;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 4px 8px rgba(0,0,0,0.15);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen
button:hover {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #1e40af;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(-2px);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>#introScreen
button:active {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transform:
translateY(0);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Estilos del
teclado virtual */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>#virtualKeyboard {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>display:
flex;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>justify-content: center;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>align-items: flex-start; /* Alinea las teclas blancas en la parte
superior */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-top: 15px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>position:
relative;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #334155; /* Fondo oscuro para el teclado */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>padding:
10px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>border-radius: 10px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 5px 15px rgba(0,0,0,0.2);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width:
98%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>max-width:
600px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-sizing: border-box;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>overflow-x: auto; /* Permite desplazamiento lateral en pantallas pequeñas
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>padding-bottom: 20px; /* Espacio para las teclas negras */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.key {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>position:
relative;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>border:
1px solid #94a3b8;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-radius: 5px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>cursor:
pointer;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>transition:
background-color 0.1s ease;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-sizing: border-box;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>user-select: none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.white-key {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #ffffff;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>width:
40px; /* Ancho de tecla blanca */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
120px; /* Altura de tecla blanca */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-right: 2px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>z-index:
1;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.white-key:last-child {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-right: 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.black-key {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #000000;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span>width: 25px; /* Ancho de tecla negra
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>height:
70px; /* Altura de tecla negra */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>position:
absolute;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>margin-left: -12.5px; /* Centra la tecla negra entre dos blancas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>z-index:
2;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>   </span>/* Posicionamiento de las teclas negras
(Desktop) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Base:
(white_key_width * white_key_index) + (white_key_margin * (white_key_index -
1)) - (black_key_width / 2) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/*
white_key_width = 40px, white_key_margin = 2px, black_key_width = 25px,
half_black_key = 12.5px */<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;CS&quot;][data-octave=&quot;4&quot;] { left:
calc(40px - 12.5px); } /* C#4, after 1st white key (C) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;DS&quot;][data-octave=&quot;4&quot;] { left:
calc((40px * 2) + (2px * 1) - 12.5px); } /* D#4, after 2nd white key (D) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Skip E - F
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;FS&quot;][data-octave=&quot;4&quot;] { left:
calc((40px * 4) + (2px * 3) - 12.5px); } /* F#4, after 4th white key (F) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;GS&quot;][data-octave=&quot;4&quot;] { left:
calc((40px * 5) + (2px * 4) - 12.5px); } /* G#4, after 5th white key (G) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;AS&quot;][data-octave=&quot;4&quot;] { left:
calc((40px * 6) + (2px * 5) - 12.5px); } /* A#4, after 6th white key (A) */<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Para la
segunda octava (octave 5) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Ancho total
de una octava: (40px * 7 teclas blancas) + (2px * 6 márgenes) = 280 + 12 =
292px */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;CS&quot;][data-octave=&quot;5&quot;] { left:
calc(292px + 40px - 12.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.black-key[data-note=&quot;DS&quot;][data-octave=&quot;5&quot;]
{ left: calc(292px + (40px * 2) + (2px * 1) - 12.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;FS&quot;][data-octave=&quot;5&quot;] { left:
calc(292px + (40px * 4) + (2px * 3) - 12.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;GS&quot;][data-octave=&quot;5&quot;] { left:
calc(292px + (40px * 5) + (2px * 4) - 12.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key[data-note=&quot;AS&quot;][data-octave=&quot;5&quot;] { left:
calc(292px + (40px * 6) + (2px * 5) - 12.5px); }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>.key.active {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #facc15; /* Amarillo para tecla activa (durante
reproducción de audio) */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 0 15px #facc15;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.key.selected-by-user { /* Nuevo estilo para teclas seleccionadas por el
usuario */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #2563eb; /* Azul para selección del usuario */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>box-shadow: 0 0 10px #2563eb;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>border-color: #1e40af;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.white-key.selected-by-user {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #2563eb;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>.black-key.selected-by-user {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>background-color: #1e40af; /* Un azul más oscuro para teclas negras
seleccionadas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/* Ajustes
responsivos */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>@media
(max-width: 768px) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>body {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding: 3px; /* Aún menos relleno para pantallas muy pequeñas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.container
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding: 10px; /* Relleno ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding-bottom: 15px; /* Relleno ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>border-radius: 8px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
99%; /* Mayor ancho en pantallas pequeñas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>max-height: 99.5vh; /* Altura máxima para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>h1 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1.5em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>h2 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1.1em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.note-building-controls
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>flex-direction: column; /* Apila los botones naturales y accidentales */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>gap:
6px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.natural-note-buttons, .accidental-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>min-width: unset; /* Elimina el ancho mínimo para permitir total
flexibilidad */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.accidental-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>grid-template-columns: repeat(4, 1fr); /* 4 columnas para accidentales
en pantallas pequeñas */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>max-width: unset; /* Elimina el ancho máximo */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.note-button {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.7em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding: 5px 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>/*
.button-group-inline {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>display: none;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.action-buttons-group {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>flex-direction: column; /* Apila los botones de verificación/siguiente
*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>gap:
6px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.action-buttons-group button {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>        </span>#questionArea p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1.1em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.grid-cell
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.9em; /* Ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding: 6px 4px; /* Ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.interval-label {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.6em; /* Ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.note-display {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1.1em; /* Ajustado para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#selectedNotesDisplay, #currentBuildingNoteDisplay {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>        </span>font-size: 0.8em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.modal-content .modal-buttons {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>flex-direction: column;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.modal-content .modal-buttons button {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
100%;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#feedbackModalContent p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.8em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#feedbackModalContent strong {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.9em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#feedbackModalContent span {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 0.8em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#introScreen h2 {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1.8em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#introScreen p {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>font-size: 1em;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>#virtualKeyboard {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
100%; /* Ocupa todo el ancho disponible */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>padding: 5px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.white-key
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
25px; /* Reducir ancho de teclas blancas en móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>height: 80px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.black-key
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>width:
15px; /* Reducir ancho de teclas negras en móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>height: 50px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>margin-left: -7.5px;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>/* Ajustar
posiciones de teclas negras para móvil */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>/*
white_key_width = 25px, white_key_margin = 2px, black_key_width = 15px,
half_black_key = 7.5px */<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>/* Total
width of one octave for mobile: (25px * 7) + (2px * 6) = 175px + 12px = 187px
*/<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;CS&quot;][data-octave=&quot;4&quot;] { left:
calc(25px - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;DS&quot;][data-octave=&quot;4&quot;] { left:
calc((25px * 2) + (2px * 1) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;FS&quot;][data-octave=&quot;4&quot;] { left:
calc((25px * 4) + (2px * 3) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;GS&quot;][data-octave=&quot;4&quot;] { left:
calc((25px * 5) + (2px * 4) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;AS&quot;][data-octave=&quot;4&quot;] { left:
calc((25px * 6) + (2px * 5) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;CS&quot;][data-octave=&quot;5&quot;] { left:
calc(187px + 25px - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;DS&quot;][data-octave=&quot;5&quot;] { left:
calc(187px + (25px * 2) + (2px * 1) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;FS&quot;][data-octave=&quot;5&quot;] { left:
calc(187px + (25px * 4) + (2px * 3) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>.black-key[data-note=&quot;GS&quot;][data-octave=&quot;5&quot;]
{ left: calc(187px + (25px * 5) + (2px * 4) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>.black-key[data-note=&quot;AS&quot;][data-octave=&quot;5&quot;] { left:
calc(187px + (25px * 6) + (2px * 5) - 7.5px); }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/style&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/head&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;body&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;!-- Pantalla
de Inicio --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;div
id=&quot;introScreen&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>&lt;h2&gt;Bienvenido a Bloque Armónico Pro&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>&lt;p&gt;Herramienta para desarrollar la técnica de armonización en
bloques cerrados 4-way closed.&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>&lt;p&gt;Realizado por Juan Miguel Rios Redondo&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;button
id=&quot;startButton&quot;&gt;Comenzar&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;div
class=&quot;container&quot; id=&quot;quizContainer&quot; style=&quot;display:
none;&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>&lt;h2&gt;Pregunta:&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
id=&quot;questionArea&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;p
id=&quot;chordQuestionText&quot;&gt;Cargando pregunta...&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>&lt;button
id=&quot;playChordButton&quot; style=&quot;margin-top: 5px; padding: 8px 15px;
background-color: #3b82f6; color: white; border: none; border-radius: 8px;
cursor: pointer;&quot;&gt;Reproducir Acorde&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;div
class=&quot;notes-grid&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>&lt;div
class=&quot;grid-cell&quot; id=&quot;gridCell0&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;interval-label&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;note-display&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div class=&quot;grid-cell&quot; id=&quot;gridCell1&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;interval-label&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;note-display&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div class=&quot;grid-cell&quot; id=&quot;gridCell2&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;interval-label&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;note-display&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div class=&quot;grid-cell&quot; id=&quot;gridCell3&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;interval-label&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;span class=&quot;note-display&quot;&gt;&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>   </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
class=&quot;input-group&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;label&gt;Selecciona las 4 notas del acorde:&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;div
class=&quot;note-building-controls&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div id=&quot;naturalNoteButtons&quot;
class=&quot;natural-note-buttons&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;!-- Los botones de notas naturales se generarán aquí --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div id=&quot;accidentalButtons&quot;
class=&quot;accidental-buttons&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;!-- Los botones de accidentales se generarán aquí --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;!--
Removed &quot;Add Note to Answer&quot; and &quot;Clear Current Note&quot;
buttons --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;!--
&lt;div class=&quot;button-group-inline&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;button id=&quot;addNoteToAnswerButton&quot;&gt;Añadir Nota a la
Respuesta&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>               </span>&lt;button
id=&quot;clearCurrentNoteButton&quot;&gt;Limpiar Nota Actual&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/div&gt; --&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;label
style=&quot;margin-top: 20px;&quot;&gt;Notas de tu Respuesta (máx.
4):&lt;/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;div
id=&quot;selectedNotesDisplay&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>Notas
seleccionadas: Ninguna<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;!--
Botones de acción --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
class=&quot;action-buttons-group&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;button
id=&quot;confirmAnswerButton&quot;&gt;Confirmar&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;button
id=&quot;clearAllSelectionButton&quot;&gt;Borrar&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;button
id=&quot;changeQuestionButton&quot;&gt;Cambiar Pregunta&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;!--
Teclado Virtual de Piano --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
id=&quot;virtualKeyboard&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;!--
Las teclas se generarán con JavaScript --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;!-- Modal de
Feedback --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;div
id=&quot;feedbackModalOverlay&quot; class=&quot;modal-overlay&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
id=&quot;feedbackModalContent&quot; class=&quot;modal-content&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;!-- El
mensaje de feedback se insertará aquí --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;!-- Modal de
Evaluación --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;div
id=&quot;evaluationModalOverlay&quot; class=&quot;modal-overlay&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;div
class=&quot;modal-content&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;h3&gt;Resultados de la Evaluación&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;p
id=&quot;evaluationSummary&quot;&gt;&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;p&gt;Áreas a trabajar:&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span>&lt;ul id=&quot;adviceList&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;!-- Los elementos de consejo se insertarán aquí --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/ul&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&lt;div
class=&quot;modal-buttons&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;button id=&quot;continueQuizButton&quot;&gt;Continuar
Quiz&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;button id=&quot;endQuizButton&quot;&gt;Terminar Quiz&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;!--
Visualización del mensaje final (después de terminar el quiz) --&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;div
id=&quot;finalMessageDisplay&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;h3&gt;Quiz
Finalizado&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>&lt;p&gt;¡Gracias por practicar!&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;p
class=&quot;results-summary&quot;
id=&quot;finalResultsSummary&quot;&gt;&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;p
class=&quot;email-info&quot;&gt;En una aplicación real, estos resultados serían
enviados a tu correo electrónico para que puedas revisarlos más
tarde.&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>&lt;p
class=&quot;email-info&quot;&gt;Para enviar un correo de prueba con tus
resultados, haz clic &lt;a id=&quot;mailtoLink&quot; href=&quot;#&quot;
target=&quot;_blank&quot;&gt;aquí&lt;/a&gt;.&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;script&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Canonical
notes (for internal calculations, using sharps)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
canonicalNotes = [&quot;C&quot;, &quot;C#&quot;, &quot;D&quot;, &quot;D#&quot;,
&quot;E&quot;, &quot;F&quot;, &quot;F#&quot;, &quot;G&quot;, &quot;G#&quot;,
&quot;A&quot;, &quot;A#&quot;, &quot;B&quot;];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Mapping
from various note spellings (including enharmonics) to their semitone value
from C<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
noteToSemitoneMap = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;C&quot;: 0, &quot;C#&quot;: 1, &quot;DB&quot;: 1, &quot;C##&quot;:
2, // C## is D<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;D&quot;: 2, &quot;D#&quot;: 3, &quot;EB&quot;: 3, &quot;D##&quot;:
4, // D## is E<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;E&quot;: 4, &quot;E#&quot;: 5, &quot;FB&quot;: 4, // E# is F, Fb
is E<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;F&quot;: 5, &quot;F#&quot;: 6, &quot;GB&quot;: 6, &quot;F##&quot;:
7, // F## is G<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;G&quot;: 7, &quot;G#&quot;: 8, &quot;AB&quot;: 8, &quot;G##&quot;:
9, // G## is A<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;A&quot;: 9, &quot;A#&quot;: 10, &quot;BB&quot;: 10,
&quot;A##&quot;: 11, // A## is B<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;B&quot;: 11, &quot;B#&quot;: 0, &quot;CB&quot;: 11, // B# is C, Cb
is B<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;DBB&quot;: 0, // Dbb is C<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;EBB&quot;: 2, // Ebb is D<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;FBB&quot;: 3, // Fbb is Eb (D#)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>&quot;GBB&quot;:
5, // Gbb is F<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;ABB&quot;: 7, // Abb is G<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;BBB&quot;: 9, // Bbb is A<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;CBB&quot;: 10 // Cbb is Bb (A#)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Notes for
the natural note buttons<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
naturalNotes = [&quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;,
&quot;G&quot;, &quot;A&quot;, &quot;B&quot;];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Notes for
the accidental buttons<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
accidentals = [&quot;#&quot;, &quot;##&quot;, &quot;b&quot;, &quot;bb&quot;];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Definition
of chord structures in semitones and their names, including labels for the grid<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
chordStructures = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;maj7&quot;: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>               </span>name: &quot;Mayor Séptima
(maj7)&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>intervals: [ // Base intervals for the chord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 0, name: &quot;fundamental&quot;, label: &quot;1&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 4, name: &quot;tercera&quot;, label: &quot;3&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>        </span>{ semitones: 7, name:
&quot;quinta&quot;, label: &quot;5&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 11, name: &quot;séptima&quot;, label: &quot;7&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 2, name: &quot;novena&quot;, label: &quot;9&quot; }, // Major 9th<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 6, name: &quot;onceava aumentada&quot;, label: &quot;#11&quot; } //
#11 tension<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Defines the labels of the 4 notes in the voicing, in descending order from the
lead voice<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
These are the *default* rules, subject to exceptions like maj7-fundamental-6<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>voicing_rules: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;1&quot;: [&quot;1&quot;, &quot;7&quot;, &quot;5&quot;,
&quot;3&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;3&quot;: [&quot;3&quot;, &quot;1&quot;, &quot;7&quot;,
&quot;5&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;5&quot;: [&quot;5&quot;, &quot;3&quot;, &quot;1&quot;,
&quot;7&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;7&quot;: [&quot;7&quot;, &quot;5&quot;, &quot;3&quot;,
&quot;1&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;9&quot;: [&quot;9&quot;, &quot;7&quot;, &quot;5&quot;,
&quot;3&quot;], // 9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;#11&quot;: [&quot;#11&quot;, &quot;3&quot;, &quot;1&quot;,
&quot;7&quot;] // #11 replaces 5, order: Tension, 3, 1, 7<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;m7&quot;: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>name:
&quot;Menor Séptima (m7)&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>intervals: [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 0, name: &quot;fundamental&quot;, label: &quot;1&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 3, name: &quot;tercera&quot;, label: &quot;b3&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 7, name: &quot;quinta&quot;, label: &quot;5&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 10, name: &quot;séptima&quot;, label: &quot;b7&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 2, name: &quot;novena&quot;, label: &quot;9&quot; }, // Major 9th<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 5, name: &quot;onceava&quot;, label: &quot;11&quot; } // Perfect 4th
from root<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>voicing_rules: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'>     </span>&quot;1&quot;: [&quot;1&quot;,
&quot;b7&quot;, &quot;5&quot;, &quot;b3&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b3&quot;: [&quot;b3&quot;, &quot;1&quot;, &quot;b7&quot;,
&quot;5&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;5&quot;: [&quot;5&quot;, &quot;b3&quot;, &quot;1&quot;,
&quot;b7&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b7&quot;: [&quot;b7&quot;, &quot;5&quot;, &quot;b3&quot;,
&quot;1&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;9&quot;: [&quot;9&quot;, &quot;b7&quot;, &quot;5&quot;,
&quot;b3&quot;], // 9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>            </span>&quot;11&quot;: [&quot;11&quot;,
&quot;b3&quot;, &quot;1&quot;, &quot;b7&quot;] // 11 replaces 5, order:
Tension, b3, 1, b7<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;7&quot;: { // Dominant 7th chord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>name:
&quot;Dominante Séptima (7)&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>intervals: [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 0, name: &quot;fundamental&quot;, label: &quot;1&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 4, name: &quot;tercera&quot;, label: &quot;3&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 7, name: &quot;quinta&quot;, label: &quot;5&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 10, name: &quot;séptima&quot;, label: &quot;b7&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>                 </span>{ semitones: 2, name:
&quot;novena&quot;, label: &quot;9&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 1, name: &quot;novena menor&quot;, label: &quot;b9&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 3, name: &quot;novena aumentada&quot;, label: &quot;#9&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 6, name: &quot;onceava aumentada&quot;, label: &quot;#11&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 9, name: &quot;trecena&quot;, label: &quot;13&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 5, name: &quot;onceava&quot;, label: &quot;11&quot; } // Perfect 4th
from root<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>voicing_rules: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;1&quot;: [&quot;1&quot;, &quot;b7&quot;, &quot;5&quot;,
&quot;3&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;3&quot;: [&quot;3&quot;, &quot;1&quot;, &quot;b7&quot;,
&quot;5&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;5&quot;: [&quot;5&quot;, &quot;3&quot;, &quot;1&quot;,
&quot;b7&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b7&quot;: [&quot;b7&quot;, &quot;5&quot;, &quot;3&quot;,
&quot;1&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;9&quot;: [&quot;9&quot;, &quot;b7&quot;, &quot;5&quot;,
&quot;3&quot;], // 9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b9&quot;: [&quot;b9&quot;, &quot;b7&quot;, &quot;5&quot;,
&quot;3&quot;], // b9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;#9&quot;: [&quot;#9&quot;, &quot;b7&quot;, &quot;5&quot;,
&quot;3&quot;], // #9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;11&quot;: [&quot;11&quot;, &quot;1&quot;, &quot;b7&quot;,
&quot;5&quot;], // 11 replaces 3, order: Tension, 1, b7, 5 (User's specific
rule for 7 chord)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;#11&quot;: [&quot;#11&quot;, &quot;3&quot;, &quot;1&quot;,
&quot;b7&quot;], // #11 replaces 5, order: Tension, 3, 1, b7 (User's specific
rule for #11 in 7 chord)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;13&quot;: [&quot;13&quot;, &quot;3&quot;, &quot;1&quot;,
&quot;b7&quot;] // 13 replaces 5, order: Tension, 3, 1, 7 (User's specific rule
for 13)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;m7b5&quot;: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>name:
&quot;Menor Séptima con 5ta Disminuida (m7b5)&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>intervals: [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 0, name: &quot;fundamental&quot;, label: &quot;1&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 3, name: &quot;tercera&quot;, label: &quot;b3&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 6, name: &quot;quinta&quot;, label: &quot;b5&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 10, name: &quot;séptima&quot;, label: &quot;b7&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 5, name: &quot;onceava&quot;, label: &quot;11&quot; }, // Perfect
4th from root<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 1, name: &quot;novena menor&quot;, label: &quot;b9&quot; } // b9
tension<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>voicing_rules: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;1&quot;: [&quot;1&quot;, &quot;b7&quot;, &quot;b5&quot;,
&quot;b3&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b3&quot;: [&quot;b3&quot;, &quot;1&quot;, &quot;b7&quot;,
&quot;b5&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b5&quot;: [&quot;b5&quot;, &quot;b3&quot;, &quot;1&quot;,
&quot;b7&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b7&quot;: [&quot;b7&quot;, &quot;b5&quot;, &quot;b3&quot;,
&quot;1&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b9&quot;: [&quot;b9&quot;, &quot;b7&quot;, &quot;b5&quot;,
&quot;b3&quot;], // b9 replaces 1<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
For m7b5 with 11th lead, the rule is 11, b3, b7, b5 (omits root, not 5th, as
previously confirmed)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;11&quot;: [&quot;11&quot;, &quot;b3&quot;, &quot;b7&quot;,
&quot;b5&quot;]<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>&quot;dim7&quot;: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>name:
&quot;Disminuido Séptima (°7)&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>   </span>intervals: [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 0, name: &quot;fundamental&quot;, label: &quot;1&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 3, name: &quot;tercera&quot;, label: &quot;b3&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 6, name: &quot;quinta&quot;, label: &quot;b5&quot; },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>{
semitones: 9, name: &quot;séptima&quot;, label: &quot;bb7&quot; }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>voicing_rules: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;1&quot;: [&quot;1&quot;, &quot;bb7&quot;, &quot;b5&quot;,
&quot;b3&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b3&quot;: [&quot;b3&quot;, &quot;1&quot;, &quot;bb7&quot;,
&quot;b5&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&quot;b5&quot;: [&quot;b5&quot;, &quot;b3&quot;, &quot;1&quot;,
&quot;bb7&quot;],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'>     </span>&quot;bb7&quot;: [&quot;bb7&quot;,
&quot;b5&quot;, &quot;b3&quot;, &quot;1&quot;]<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentCorrectNotes = []; // Stores the correct notes for the current question
(canonical form)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentChordRoot = ''; // Stores the root of the current chord for feedback
(canonical form)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentChordTypeKey = ''; // Stores the key (e.g., &quot;maj7&quot;) of the
current chord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentGivenIntervalName = ''; // Stores the name (e.g.,
&quot;fundamental&quot;) of the given interval<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentGivenLabel = ''; // Stores the label (e.g., &quot;1&quot;,
&quot;b3&quot;, &quot;11&quot;) of the given interval<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentGivenNote = ''; // Stores the actual note that was given (e.g.,
&quot;C#&quot;)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentOrderedLabelsForDisplay = []; // Stores the labels for the grid in the
specific order of the current question<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>//
currentActualChordIntervals will store the {label, semitones} objects of the
expected final voicing.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// It is built
in generateComplexQuestion.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
currentActualChordIntervals = [];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Quiz
Evaluation Variables<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
questionsAnsweredCount = 0; // Questions answered in the current batch<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
totalQuestionsAttempted = 0; // Total questions answered across all batches<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
totalCorrectAnswers = 0; // Total correct answers across all batches<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
QUESTIONS_PER_EVALUATION = 5;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Stores
performance data for the current evaluation batch: { 'chordType_intervalName':
{ correct: N, total: M } }<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
quizSessionData = {};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>      </span>// User selected notes for the final
answer list<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
selectedUserNotes = [];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// New state
for the current natural and accidental buttons clicked<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
activeNaturalNote = ''; // e.g., &quot;C&quot;, &quot;D&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
activeAccidental = ''; // e.g., &quot;#&quot;, &quot;b&quot;, &quot;##&quot;,
&quot;bb&quot; or &quot;&quot;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// DOM
elements<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
introScreen = document.getElementById('introScreen');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
startButton = document.getElementById('startButton');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
quizContainer = document.getElementById('quizContainer'); // Main quiz
container<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
chordQuestionTextDiv = document.getElementById('chordQuestionText');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
gridCells = [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.getElementById('gridCell0'),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.getElementById('gridCell1'),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.getElementById('gridCell2'),<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.getElementById('gridCell3')<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
naturalNoteButtonsContainer = document.getElementById('naturalNoteButtons');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
accidentalButtonsContainer = document.getElementById('accidentalButtons');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Removed
currentBuildingNoteDisplay, addNoteToAnswerButton, clearCurrentNoteButton<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
selectedNotesDisplay = document.getElementById('selectedNotesDisplay');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
playChordButton = document.getElementById('playChordButton'); // Audio playback
button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
virtualKeyboard = document.getElementById('virtualKeyboard'); // Virtual
keyboard container<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Main Action
Buttons<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
confirmAnswerButton = document.getElementById('confirmAnswerButton');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
clearAllSelectionButton = document.getElementById('clearAllSelectionButton');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
changeQuestionButton = document.getElementById('changeQuestionButton');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Feedback
Modal Elements<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const feedbackModalOverlay
= document.getElementById('feedbackModalOverlay');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
feedbackModalContent = document.getElementById('feedbackModalContent');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Evaluation
Modal Elements<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
evaluationModalOverlay = document.getElementById('evaluationModalOverlay');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
evaluationSummary = document.getElementById('evaluationSummary');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
adviceList = document.getElementById('adviceList');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
continueQuizButton = document.getElementById('continueQuizButton');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>       </span>const endQuizButton =
document.getElementById('endQuizButton');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Final
Message Elements<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
finalMessageDisplay = document.getElementById('finalMessageDisplay');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
finalResultsSummary = document.getElementById('finalResultsSummary');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
mailtoLink = document.getElementById('mailtoLink');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Feedback
duration in milliseconds<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>const
FEEDBACK_DURATION = 3000; // 3 seconds<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>      </span><span
style='mso-spacerun:yes'>  </span>// Global Tone.js synth instance<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let synth;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>let
audioContextStarted = false;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Initializes
the Tone.js audio context.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Called on
&quot;Start&quot; button click to comply with browser autoplay policy.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>    </span>async function startAudioContext() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;Attempting to start AudioContext...&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!audioContextStarted) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>await Tone.start();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(&quot;AudioContext started successfully!&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>audioContextStarted = true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
Initialize the synthesizer with piano-like envelope<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>synth = new Tone.PolySynth(Tone.Synth, {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>oscillator: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>                </span>type: &quot;triangle&quot; // A
slightly brighter wave for piano-like sound<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>},<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>envelope: {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>attack: 0.005,<span style='mso-spacerun:yes'>  </span>// Very fast
attack for percussive hit<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>decay: 0.2,<span style='mso-spacerun:yes'>     </span>// Fast decay<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>sustain: 0.1,<span style='mso-spacerun:yes'>   </span>// Low sustain<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>release: 0.5<span style='mso-spacerun:yes'>    </span>// Moderate
release<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>}).toDestination();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'>           </span>playChordButton.disabled = false; //
Enable playback button once synth is ready<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(&quot;Synth initialized and playChordButton enabled.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}
catch (e) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.error(&quot;Error al iniciar AudioContext:&quot;, e);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
Inform the user that audio could not be started<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>playChordButton.disabled = true; // Ensure button remains disabled<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
Using a custom message box instead of alert()<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'>           </span>showCustomMessage(&quot;Error de
Audio&quot;, &quot;No se pudo iniciar el audio. Por favor, asegúrate de que tu
navegador lo permita.&quot;, &quot;error&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;AudioContext already started.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Shows a
custom message box (replaces alert()).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} title - Title of the message.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} message - Content of the message.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} type - 'info', 'success', 'error', 'warning' for styling.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
showCustomMessage(title, message, type = 'info') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
modalOverlay = document.createElement('div');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>modalOverlay.classList.add('modal-overlay', 'visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>modalOverlay.style.zIndex = 1002; // Higher z-index than other modals<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
modalContent = document.createElement('div');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>modalContent.classList.add('modal-content');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>modalContent.innerHTML = `<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>   </span>&lt;h3&gt;${title}&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;p&gt;${message}&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;div class=&quot;modal-buttons&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>&lt;button
id=&quot;customMessageCloseButton&quot;&gt;Cerrar&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Apply
type-specific styling<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>          </span>if (type === 'error') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>modalContent.style.backgroundColor = '#fee2e2';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>modalContent.style.color = '#b91c1c';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>modalContent.style.border = '1px solid #b91c1c';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else if
(type === 'success') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                
</span>modalContent.style.backgroundColor = '#dcfce7';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                
</span>modalContent.style.color = '#15803d';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                
</span>modalContent.style.border = '1px solid #15803d';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>modalOverlay.appendChild(modalContent);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.body.appendChild(modalOverlay);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
closeButton = document.getElementById('customMessageCloseButton');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>closeButton.style.backgroundColor = '#64748b'; // Grey button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>closeButton.style.color = 'white';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>closeButton.addEventListener('click', () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>modalOverlay.classList.remove('visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>setTimeout(() =&gt; modalOverlay.remove(), 300); // Remove from DOM
after transition<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Normalizes
a note to its canonical sharp representation for internal comparison.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Uses
noteToSemitoneMap for comprehensive enharmonic handling.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} note - The note to normalize (e.g., &quot;C#&quot;, &quot;Db&quot;).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>      </span>* @returns {string} The normalized note
(e.g., &quot;C#&quot;, &quot;D&quot;).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
normalizeNote(note) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
upperNote = note.trim().toUpperCase();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
semitone = noteToSemitoneMap[upperNote];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(semitone !== undefined) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>return
canonicalNotes[semitone];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.warn(`Unrecognized note for normalization: ${note}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>return
upperNote; // Fallback for unrecognized notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Updates the
display of selected notes (final answer list) and button visibility.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
updateSelectedNotesDisplay() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
displayNotesArray = new Array(4).fill(''); // Array to hold notes for display<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if (selectedUserNotes.length
&gt; 0 &amp;&amp; currentOrderedLabelsForDisplay.length === 4) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
correctNotesByLabel = {};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
actualRootSemitone = noteToSemitoneMap[currentChordRoot];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
currentActualChordIntervals is already built with the specific voicing rule
applied<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// It
contains the 4 labels and their relative semitones to the root for the expected
answer<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>currentActualChordIntervals.forEach(int =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const noteSemitone = (actualRootSemitone + int.semitones + 12) % 12;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>correctNotesByLabel[int.label] = canonicalNotes[noteSemitone];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Iterate through ordered labels and try to match user's notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>currentOrderedLabelsForDisplay.forEach((label, index) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const canonicalCorrectNoteForThisLabel = correctNotesByLabel[label];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const matchingUserNote = selectedUserNotes.find(userNote =&gt;
normalizeNote(userNote) === canonicalCorrectNoteForThisLabel);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>if
(matchingUserNote) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>displayNotesArray[index] = matchingUserNote;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>if (selectedUserNotes.length === 0)
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>selectedNotesDisplay.innerHTML = 'Notas seleccionadas: Ninguna';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Filter out empty strings before joining for cleaner display if fewer than 4
notes are selected<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>selectedNotesDisplay.innerHTML = `Notas seleccionadas:
&lt;strong&gt;${selectedUserNotes.join(', ')}&lt;/strong&gt;`; // Display raw
user notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Control
visibility/disabled state of action buttons<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>confirmAnswerButton.style.display
= selectedUserNotes.length === 4 ? 'block' : 'none';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>confirmAnswerButton.disabled = selectedUserNotes.length !== 4;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>clearAllSelectionButton.style.display = selectedUserNotes.length &gt; 0
? 'block' : 'none';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>clearAllSelectionButton.disabled = selectedUserNotes.length === 0;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>changeQuestionButton.style.display = 'block'; // Always visible<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>changeQuestionButton.disabled = false; // Always enabled (unless quiz is
generally disabled)<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Update
button selection visual state<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>updateButtonSelectionVisuals();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Update
keyboard highlighting for user selection<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>updateKeyboardHighlightingForSelection();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Updates the
visual state of the natural and accidental buttons based on selectedUserNotes.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
updateButtonSelectionVisuals() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>       </span>// Remove all 'selected' classes first<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.querySelectorAll('.note-button').forEach(button =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.classList.remove('selected');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Apply
'selected' class to buttons that form part of selected notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>selectedUserNotes.forEach(userNote =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
naturalPart = userNote.match(/[A-G]/i)[0];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
accidentalPart = userNote.replace(naturalPart, '');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Select natural button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
naturalButton = document.querySelector(`.natural-note-buttons
button[data-note=&quot;${naturalPart}&quot;]`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(naturalButton) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>naturalButton.classList.add('selected');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Select accidental button if present<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(accidentalPart) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const accidentalButton = document.querySelector(`.accidental-buttons
button[data-accidental=&quot;${accidentalPart}&quot;]`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>if
(accidentalButton) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>accidentalButton.classList.add('selected');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Disable
note selection buttons if 4 notes are already selected<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
naturalButtons = naturalNoteButtonsContainer.querySelectorAll('.note-button');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
accidentalButtons =
accidentalButtonsContainer.querySelectorAll('.note-button');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(selectedUserNotes.length &gt;= 4) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>naturalButtons.forEach(button =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>        </span>if
(!button.classList.contains('selected')) { // Only disable if not already
selected<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>button.classList.add('disabled');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>accidentalButtons.forEach(button =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span><span
style='mso-spacerun:yes'>            </span>if
(!button.classList.contains('selected')) { // Only disable if not already
selected<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>button.classList.add('disabled');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>naturalButtons.forEach(button =&gt;
button.classList.remove('disabled'));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>accidentalButtons.forEach(button =&gt;
button.classList.remove('disabled'));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Toggles a
note in the selectedUserNotes array.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} note - The note string (e.g., &quot;C&quot;, &quot;C#&quot;,
&quot;Db&quot;).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
toggleNoteInAnswer(note) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
normalizedNote = normalizeNote(note);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
index = selectedUserNotes.findIndex(n =&gt; normalizeNote(n) ===
normalizedNote);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if (index
&gt; -1) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Note found, remove it<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>selectedUserNotes.splice(index, 1);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Note not found, add it if less than 4 notes are selected<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(selectedUserNotes.length &lt; 4) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>selectedUserNotes.push(note);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>} else
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>showCustomMessage(&quot;Límite de Notas&quot;, &quot;Ya has seleccionado
4 notas. Por favor, deselecciona una antes de añadir otra.&quot;,
&quot;info&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>return; // Do not update visuals if not added<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>updateSelectedNotesDisplay();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Attempts to
combine active natural and accidental notes and toggle them in the answer.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
attemptToggleCombinedNote() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(activeNaturalNote !== '') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
fullNote = `${activeNaturalNote}${activeAccidental}`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>toggleNoteInAnswer(fullNote);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Reset active selections after attempting to toggle<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>activeNaturalNote = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>activeAccidental = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Deselect natural and accidental buttons visually<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>document.querySelectorAll('.natural-note-buttons
.note-button.selected').forEach(button =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>button.classList.remove('selected');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>document.querySelectorAll('.accidental-buttons
.note-button.selected').forEach(button =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>button.classList.remove('selected');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Handles
click on a natural note button.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{Event} event - The click event.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
handleNaturalNoteClick(event) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
clickedNote = event.target.dataset.note;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!clickedNote || event.target.classList.contains('disabled')) return;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// If a
natural note is already active and the same one is clicked, it means<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// the
user is trying to deselect it or finalize a selection with no accidental.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(activeNaturalNote === clickedNote) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(activeAccidental === '') { // If no accidental is active, toggle the natural
note itself<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>toggleNoteInAnswer(clickedNote);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// In
any case, reset activeNaturalNote<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>activeNaturalNote
= '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// Set
the new active natural note<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>activeNaturalNote = clickedNote;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// If an
accidental is already active, attempt to toggle the combined note<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(activeAccidental !== '') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>attemptToggleCombinedNote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// If
no accidental is active, just update button visuals and keyboard highlighting<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>updateButtonSelectionVisuals();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span><span
style='mso-spacerun:yes'>    </span>updateKeyboardHighlightingForSelection();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Handles
click on an accidental button.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{Event} event - The click event.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
handleAccidentalClick(event) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           </span><span
style='mso-spacerun:yes'> </span>const clickedAccidental =
event.target.dataset.accidental;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!clickedAccidental || event.target.classList.contains('disabled')) return;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// If an
accidental is already active and the same one is clicked, it means<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// the
user is trying to deselect it or finalize a selection with the current natural.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(activeAccidental === clickedAccidental) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(activeNaturalNote === '') { // If no natural is active, this click is
ambiguous, do nothing or show message<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>showCustomMessage(&quot;Selección&quot;, &quot;Por favor, selecciona
primero una nota natural (C, D, E, F, G, A, B).&quot;, &quot;info&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// In
any case, reset activeAccidental<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>activeAccidental = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// Set
the new active accidental<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>activeAccidental = clickedAccidental;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// If a
natural note is already active, attempt to toggle the combined note<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(activeNaturalNote !== '') {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>attemptToggleCombinedNote();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// If
no natural note is active, just update button visuals and keyboard highlighting<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>updateButtonSelectionVisuals();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>updateKeyboardHighlightingForSelection();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Limpia
todas las notas seleccionadas en la lista de respuesta final.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
clearSelection() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>selectedUserNotes = [];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>activeNaturalNote = ''; // Reset active selection states<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>activeAccidental = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>updateSelectedNotesDisplay(); // This will also handle button and
keyboard visuals<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Genera los
botones de notas naturales y accidentales.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
generateNoteButtons() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>naturalNoteButtonsContainer.innerHTML = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>naturalNotes.forEach(note =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
button = document.createElement('button');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.textContent = note;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.classList.add('note-button');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.dataset.note = note;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>naturalNoteButtonsContainer.appendChild(button);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span>naturalNoteButtonsContainer.addEventListener('click',
handleNaturalNoteClick);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>accidentalButtonsContainer.innerHTML = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>accidentals.forEach(accidental =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
button = document.createElement('button');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>             </span>button.textContent = accidental;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.classList.add('note-button');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>button.dataset.accidental = accidental;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>accidentalButtonsContainer.appendChild(button);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>accidentalButtonsContainer.addEventListener('click',
handleAccidentalClick);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Removed
addNoteToAnswerButton and clearCurrentNoteButton event listeners<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Plays the
current correct chord as a descending arpeggio followed by a simultaneous
chord.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>async function
playChord() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;playChord: Checking audioContextStarted:&quot;,
audioContextStarted);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!audioContextStarted) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.warn(&quot;playChord: AudioContext not started. Attempting to
start before playing.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>await
startAudioContext();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(!audioContextStarted) { // Check again after attempting to start<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.error(&quot;playChord: Failed to start AudioContext, cannot play
chord.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!synth) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.warn(&quot;playChord: Synth not initialized. Cannot play
chord.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(currentCorrectNotes.length === 0) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.warn(&quot;playChord: No notes to play.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
notesToPlayWithOctaves = [];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
currentOctave = 5; // Start the highest note in octave 5<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
lastNoteSemitone = noteToSemitoneMap[currentCorrectNotes[0]];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>notesToPlayWithOctaves.push(`${currentCorrectNotes[0]}${currentOctave}`);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>for (let i
= 1; i &lt; currentCorrectNotes.length; i++) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
noteName = currentCorrectNotes[i];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
noteSemitone = noteToSemitoneMap[noteName];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// If
the current note's semitone is higher than the last one encountered in the
descending sequence,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// it
means we've wrapped around to a lower octave.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(noteSemitone &gt; lastNoteSemitone) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>currentOctave--;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>notesToPlayWithOctaves.push(`${noteName}${currentOctave}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>lastNoteSemitone = noteSemitone;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;playChord: Notes to play with octaves:&quot;,
notesToPlayWithOctaves);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// ---
Descending Arpeggio ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
arpeggioNoteDuration = &quot;8n&quot;; // Duration of each note in arpeggio
(e.g., 8th note)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Adjusted for less latency perception<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
arpeggioDelayBetweenNotes = 0.2; // Reduced from 0.45s to 0.2s<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
arpeggioStartTime = Tone.now();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;playChord: Arpeggio start time:&quot;,
arpeggioStartTime);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>for (let i
= 0; i &lt; notesToPlayWithOctaves.length; i++) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Schedule each note with a delay<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
noteToHighlight = notesToPlayWithOctaves[i];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>Tone.Transport.scheduleOnce((time) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(`playChord: Triggering arpeggio note ${noteToHighlight} at
${time}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>synth.triggerAttackRelease(noteToHighlight, arpeggioNoteDuration, time);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>highlightKeyboardKeyForPlayback(noteToHighlight, arpeggioNoteDuration);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>},
arpeggioStartTime + (i * arpeggioDelayBetweenNotes));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// ---
Simultaneous Chord after Arpeggio ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Calculate when the arpeggio finishes to start the chord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
chordStartTime = arpeggioStartTime + (notesToPlayWithOctaves.length *
arpeggioDelayBetweenNotes) + 0.1; // Reduced pause<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>const chordDuration =
&quot;0.7s&quot;; // Reduced from 1s to 0.7s<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;playChord: Chord start time:&quot;, chordStartTime);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>Tone.Transport.scheduleOnce((time) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(`playChord: Triggering chord ${notesToPlayWithOctaves.join(',
')} at ${time}`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>synth.triggerAttackRelease(notesToPlayWithOctaves, chordDuration, time);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Highlight all notes of the chord simultaneously<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>notesToPlayWithOctaves.forEach(note =&gt; highlightKeyboardKeyForPlayback(note,
chordDuration));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>},
chordStartTime);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Start
Tone.js Transport if not already running<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(Tone.Transport.state !== &quot;started&quot;) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>Tone.Transport.start();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>   </span>console.log(&quot;playChord: Tone.Transport
started.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;playChord: Tone.Transport already started.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Highlights
a key on the virtual keyboard for a given duration for *playback*.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} noteWithOctave - The note (e.g., &quot;C4&quot;, &quot;G#5&quot;).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* @param
{string} duration - The duration for which to highlight (e.g., &quot;8n&quot;,
&quot;1s&quot;).<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
highlightKeyboardKeyForPlayback(noteWithOctave, duration) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
[noteName, octave] = Tone.Frequency(noteWithOctave).split();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Convert
Tone.js format (C#) to data-note format (CS)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const dataNote
= noteName.replace('#', 'S').replace('b', 'B');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
keyElement =
document.querySelector(`.key[data-note=&quot;${dataNote}&quot;][data-octave=&quot;${octave}&quot;]`);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(keyElement) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Temporarily add 'active' class for playback visual feedback<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>keyElement.classList.add('active');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Remove highlight after duration<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>Tone.Transport.scheduleOnce((time) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>keyElement.classList.remove('active');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'> </span>}, Tone.now() +
Tone.Time(duration).toSeconds());<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Updates the
highlighting of keys on the virtual keyboard based on `selectedUserNotes`.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
updateKeyboardHighlightingForSelection() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Remove
all 'selected-by-user' classes first<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.querySelectorAll('.key').forEach(key =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>key.classList.remove('selected-by-user');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Add
'selected-by-user' class to keys corresponding to selected notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>selectedUserNotes.forEach(userNote =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// For
user selection, we assume the C4-B4 octave for highlighting<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
dataNote = userNote.replace('#', 'S').replace('b', 'B');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
keyElement =
document.querySelector(`.key[data-note=&quot;${dataNote}&quot;][data-octave=&quot;4&quot;]`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(keyElement) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>keyElement.classList.add('selected-by-user');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>           </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Generates
the virtual piano keyboard.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
generateVirtualKeyboard() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateVirtualKeyboard: Generating keyboard
elements.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>virtualKeyboard.innerHTML
= '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
whiteKeys = [&quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;,
&quot;G&quot;, &quot;A&quot;, &quot;B&quot;];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
blackKeys = [&quot;C#&quot;, &quot;D#&quot;, &quot;F#&quot;, &quot;G#&quot;,
&quot;A#&quot;]; // Simplified for display<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Generate two octaves (C4 to B5)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>for (let
octave = 4; octave &lt;= 5; octave++) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>whiteKeys.forEach(note =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const key = document.createElement('div');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.classList.add('key', 'white-key');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.dataset.note = note;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.dataset.octave = octave;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>virtualKeyboard.appendChild(key);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>blackKeys.forEach(note =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const key = document.createElement('div');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.classList.add('key', 'black-key');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.dataset.note = note.replace('#', 'S'); // Use 'S' for sharp in
data-attribute to avoid issues<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>key.dataset.octave = octave;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>virtualKeyboard.appendChild(key);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>               </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateVirtualKeyboard: Keyboard elements
created.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Generates a
complex chord question with a visual grid.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
generateComplexQuestion() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Starting new question
generation.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 1.
Choose a random chord type<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
chordTypes = Object.keys(chordStructures);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
randomChordTypeKey = chordTypes[Math.floor(Math.random() * chordTypes.length)];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
selectedChordType = chordStructures[randomChordTypeKey];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentChordTypeKey = randomChordTypeKey;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Tipo de acorde
seleccionado:&quot;, currentChordTypeKey);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 2.
Choose a random interval to be the lead voice (from defined voicing rules)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
possibleLeadLabels = Object.keys(selectedChordType.voicing_rules);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(possibleLeadLabels.length === 0) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.error(`generateComplexQuestion: Error: No hay reglas de voicing
definidas para el acorde ${currentChordTypeKey}.`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>chordQuestionTextDiv.innerHTML = &quot;¡Error! No se pudo generar la
pregunta. Contacta al soporte.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>             </span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
randomLeadLabel = possibleLeadLabels[Math.floor(Math.random() *
possibleLeadLabels.length)];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentGivenLabel = randomLeadLabel;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>console.log(&quot;generateComplexQuestion:
Etiqueta de voz principal seleccionada:&quot;, currentGivenLabel);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Find
the full interval object for the chosen lead label<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
givenInterval = selectedChordType.intervals.find(int =&gt; int.label === randomLeadLabel);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!givenInterval) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.error(`generateComplexQuestion: Error: No se encontró el objeto
de intervalo para la etiqueta ${randomLeadLabel} en el acorde
${currentChordTypeKey}.`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>chordQuestionTextDiv.innerHTML = &quot;¡Error! No se pudo generar la
pregunta. Contacta al soporte.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentGivenIntervalName = givenInterval.name;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Nombre de intervalo
dado:&quot;, currentGivenIntervalName);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 3.
Choose a random note to be that interval (from canonical notes for consistency)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
givenNoteIndex = Math.floor(Math.random() * canonicalNotes.length);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentGivenNote = canonicalNotes[givenNoteIndex];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Nota dada (principal):&quot;,
currentGivenNote);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 4.
Calculate the actual root note of the chord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// The
root is 'givenNote' minus the 'givenInterval' semitones<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
actualRootSemitone = (noteToSemitoneMap[currentGivenNote] -
givenInterval.semitones + 12) % 12;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentChordRoot = canonicalNotes[actualRootSemitone];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Raíz calculada del
acorde:&quot;, currentChordRoot);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Create
a map of *all* base intervals for quick lookup (original semitones)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
originalIntervalsMap = {};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>selectedChordType.intervals.forEach(int
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>originalIntervalsMap[int.label] = int.semitones;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Determine the labels for the grid and the actual correct notes for the voicing<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
baseVoicingLabels = selectedChordType.voicing_rules[currentGivenLabel];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!baseVoicingLabels) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.error(`generateComplexQuestion: Error: No hay reglas de voicing
para la etiqueta principal &quot;${currentGivenLabel}&quot; en el acorde
${currentChordTypeKey}.`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>chordQuestionTextDiv.innerHTML = &quot;¡Error! No se pudo generar la
pregunta. Contacta al soporte.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentOrderedLabelsForDisplay = []; // Labels for the grid (e.g.,
&quot;1&quot;, &quot;6&quot;, &quot;5&quot;, &quot;3&quot;)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentCorrectNotes = []; // Actual notes for the answer (e.g.,
&quot;C&quot;, &quot;A&quot;, &quot;G&quot;, &quot;E&quot;)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>currentActualChordIntervals = []; // Will store {label, semitones} for
the expected final voicing<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span>baseVoicingLabels.forEach(label =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>let
semitonesToRoot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>let
displayLabel = label; // The label that will be displayed in the grid<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Apply the exception: maj7 and fundamental, 7th becomes 6th (note and label)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(currentChordTypeKey === &quot;maj7&quot; &amp;&amp; currentGivenIntervalName
=== &quot;fundamental&quot; &amp;&amp; label === &quot;7&quot;) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>semitonesToRoot = originalIntervalsMap[&quot;7&quot;] - 2; // Major 7th
(11) - 2 = Major 6th (9)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>displayLabel = &quot;6&quot;; // Change the label for display<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(&quot;generateComplexQuestion: Excepción maj7 aplicada: 7ma
cambiada a 6ta.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               </span><span
style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>semitonesToRoot = originalIntervalsMap[label];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(semitonesToRoot === undefined) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.error(`generateComplexQuestion: Error: La etiqueta de voicing
&quot;${label}&quot; no se encontró en originalIntervalsMap para el acorde
${currentChordTypeKey}. Esto puede indicar una regla de voicing incorrecta o un
intervalo base faltante.`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>chordQuestionTextDiv.innerHTML = &quot;¡Error! No se pudo generar la
pregunta. Contacta al soporte.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>return;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
actualNoteSemitone = (actualRootSemitone + semitonesToRoot + 12) % 12; // +12
to handle negative results<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>currentCorrectNotes.push(canonicalNotes[actualNoteSemitone]);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>currentOrderedLabelsForDisplay.push(displayLabel); // Use the
potentially modified displayLabel for the grid<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>currentActualChordIntervals.push({ label: displayLabel, semitones:
semitonesToRoot }); // Store for updateSelectedNotesDisplay<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion:
currentOrderedLabelsForDisplay (grid labels):&quot;,
currentOrderedLabelsForDisplay);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: currentCorrectNotes (expected
correct notes):&quot;, currentCorrectNotes);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: currentActualChordIntervals
(for display matching):&quot;, currentActualChordIntervals);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 6.
Formulate the question text (more concise)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
questionText = `¿Cuáles son las notas del acorde
&lt;strong&gt;${selectedChordType.name}&lt;/strong&gt; si
&lt;strong&gt;${currentGivenNote}&lt;/strong&gt; es su
&lt;strong&gt;${currentGivenIntervalName}&lt;/strong&gt;?`;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>chordQuestionTextDiv.innerHTML = questionText;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// 7.
Populate the grid visually: labels for all, note only in the first cell,
highlighted<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>gridCells.forEach((cell, index) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
intervalLabelSpan = cell.querySelector('.interval-label');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
noteDisplaySpan = cell.querySelector('.note-display');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Clear previous content and highlighting<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>noteDisplaySpan.textContent = '';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>noteDisplaySpan.classList.remove('highlighted');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Assign the determined label to the current grid cell<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>intervalLabelSpan.textContent = currentOrderedLabelsForDisplay[index];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Display
ONLY the given note in the first cell and highlight it<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
noteDisplaySpanInFirstCell = gridCells[0].querySelector('.note-display');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>noteDisplaySpanInFirstCell.textContent = currentGivenNote;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>noteDisplaySpanInFirstCell.classList.add('highlighted');<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Clear
user's selected notes and feedback message<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: Clearing selection and
feedback.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>clearSelection(); // Clear all selected notes and current building note<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>feedbackModalOverlay.classList.remove('visible');
// Ensure feedback modal is hidden<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>feedbackModalContent.className = 'modal-content'; // Reset feedback
modal classes<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Ensure
quiz elements are enabled for a new question<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span><span
style='mso-spacerun:yes'>  </span>console.log(&quot;generateComplexQuestion:
Enabling quiz interaction.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>enableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;generateComplexQuestion: New question generated
successfully.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Disables
all interactive elements of the quiz.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
disableQuizInteraction() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;disableQuizInteraction: Disabling quiz
interaction.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>confirmAnswerButton.disabled = true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>clearAllSelectionButton.disabled
= true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>changeQuestionButton.disabled = true;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>playChordButton.disabled = true; // Disable playback button<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Visually disable all note buttons<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.querySelectorAll('.note-button').forEach(button =&gt;
button.classList.add('disabled'));<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Remove
event listeners to prevent interaction<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>naturalNoteButtonsContainer.removeEventListener('click',
handleNaturalNoteClick);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>accidentalButtonsContainer.removeEventListener('click',
handleAccidentalClick);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;disableQuizInteraction: Quiz interaction
disabled.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Enables all
interactive elements of the quiz.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
enableQuizInteraction() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;enableQuizInteraction: Enabling quiz
interaction.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Button
visibility/disabled state is handled by updateSelectedNotesDisplay based on
selectedUserNotes.length<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>updateSelectedNotesDisplay();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>playChordButton.disabled = !audioContextStarted; // Enable if audio
context is active<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Add
event listeners back<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>naturalNoteButtonsContainer.addEventListener('click',
handleNaturalNoteClick);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>accidentalButtonsContainer.addEventListener('click',
handleAccidentalClick);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Visually enable all note buttons (remove disabled class)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>document.querySelectorAll('.note-button').forEach(button =&gt;
button.classList.remove('disabled'));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span><span
style='mso-spacerun:yes'>  </span>console.log(&quot;enableQuizInteraction: Quiz
interaction enabled.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Handles
changing the question without checking the answer.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
handleChangeQuestion() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;handleChangeQuestion: Change question button
clicked.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>clearSelection(); // Clear any existing selection<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>generateComplexQuestion(); // Generate a new question<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Checks the
user's answer.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>async function
checkAnswer() { // Made async to await playChord<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;checkAnswer: Starting answer check.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
userNotesNormalized = selectedUserNotes.map(note =&gt; normalizeNote(note));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;checkAnswer: Notas del usuario (normalizadas):&quot;,
userNotesNormalized);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
normalizedCorrectNotes = currentCorrectNotes.map(note =&gt;
normalizeNote(note));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;checkAnswer: Notas correctas esperadas
(normalizadas):&quot;, normalizedCorrectNotes);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Sort
both lists for order-independent comparison<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>userNotesNormalized.sort();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>normalizedCorrectNotes.sort();<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
isCorrect = false;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
feedbackHtml = '';<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Ensure
exactly 4 notes are selected for a valid answer attempt<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(userNotesNormalized.length === 4) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>isCorrect = userNotesNormalized.every((note, index) =&gt; note ===
normalizedCorrectNotes[index]);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(isCorrect) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackHtml = `&lt;p&gt;¡Correcto! <span style='font-family:"Apple Color Emoji";
mso-bidi-font-family:"Apple Color Emoji"'>&#127881;</span>&lt;/p&gt;&lt;p&gt;La
fundamental es &lt;strong&gt;${currentChordRoot}&lt;/strong&gt;. Las notas son:
&lt;strong&gt;${currentCorrectNotes.join(', ')}&lt;/strong&gt;&lt;/p&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(&quot;checkAnswer: Answer is correct. Playing chord.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>await playChord(); // Play chord if correct<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>} else
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
Detailed incorrect feedback<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           </span><span
style='mso-spacerun:yes'>         </span>feedbackHtml = `&lt;p&gt;Incorrecto.
Inténtalo de nuevo.&lt;/p&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackHtml += `&lt;p&gt;Tus notas: `;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                    </span>//
Display user's selected notes, highlighting correct/incorrect ones<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>selectedUserNotes.forEach((userNote, index) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>const normalizedUserNote = normalizeNote(userNote);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>if (normalizedCorrectNotes.includes(normalizedUserNote)) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>feedbackHtml += `&lt;span style=&quot;color: green; font-weight:
bold;&quot;&gt;${userNote}&lt;/span&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                           
</span>feedbackHtml += `&lt;span style=&quot;color: red; font-weight:
bold;&quot;&gt;${userNote}&lt;/span&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                       
</span>if (index &lt; selectedUserNotes.length - 1) feedbackHtml += &quot;,
&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackHtml += `&lt;/p&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackHtml += `&lt;p&gt;Las notas correctas son:
&lt;strong&gt;${currentCorrectNotes.join(', ')}&lt;/strong&gt;&lt;/p&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>console.log(&quot;checkAnswer: Answer is incorrect.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>feedbackHtml = `&lt;p&gt;Por favor, selecciona exactamente 4
notas.&lt;/p&gt;`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>feedbackModalContent.classList.remove('correct');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>feedbackModalContent.classList.add('incorrect');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>feedbackModalContent.innerHTML = feedbackHtml;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>feedbackModalOverlay.classList.add('visible'); // Show feedback modal<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>disableQuizInteraction();
// Disable interaction<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>setTimeout(() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackModalOverlay.classList.remove('visible'); // Hide feedback modal<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>enableQuizInteraction(); // Re-enable interaction<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>          </span><span
style='mso-spacerun:yes'>      </span>}, FEEDBACK_DURATION); // Use
FEEDBACK_DURATION<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;checkAnswer: Not 4 notes selected. Showing feedback
and returning.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>return; // Exit function if selection is not 4 notes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Update
quiz session data for evaluation<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
performanceKey = `${currentChordTypeKey}_${currentGivenIntervalName}`;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(!quizSessionData[performanceKey]) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>quizSessionData[performanceKey] = { correct: 0, total: 0 };<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>         </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>quizSessionData[performanceKey].total++;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(isCorrect) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>quizSessionData[performanceKey].correct++;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>questionsAnsweredCount++; // Increment total questions answered in this
batch<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>totalQuestionsAttempted++; // Increment total questions for overall
score<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(isCorrect) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>totalCorrectAnswers++; // Increment total correct for overall score<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;checkAnswer: Preguntas respondidas (batch):&quot;,
questionsAnsweredCount);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;checkAnswer: Total preguntas (general):&quot;,
totalQuestionsAttempted);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>console.log(&quot;checkAnswer:
Datos de sesión del quiz:&quot;, quizSessionData);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>feedbackModalContent.className = 'modal-content'; // Reset classes<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>feedbackModalContent.classList.add(isCorrect ? 'correct' : 'incorrect');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>feedbackModalContent.innerHTML = feedbackHtml;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>feedbackModalOverlay.classList.add('visible'); // Show feedback modal<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Disable
interaction while feedback/evaluation is displayed<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Check
if it's time for an evaluation<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(questionsAnsweredCount % QUESTIONS_PER_EVALUATION === 0) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;checkAnswer: ¡Es hora de la evaluación! Llamando a
displayEvaluation().&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Hide feedback modal, then show evaluation modal after a short delay<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>setTimeout(() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackModalOverlay.classList.remove('visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>displayEvaluation(); // This will show the evaluation modal<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>},
FEEDBACK_DURATION); // Use FEEDBACK_DURATION<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>// If
not evaluation, just show feedback for a short time and advance<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;checkAnswer: Not evaluation time. Showing feedback and
generating new question.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>setTimeout(() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>feedbackModalOverlay.classList.remove('visible'); // Hide feedback modal<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>generateComplexQuestion(); // Generate a new question<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>},
FEEDBACK_DURATION); // Use FEEDBACK_DURATION<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Displays
the evaluation modal with summary and advice.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
displayEvaluation() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;displayEvaluation: displayEvaluation() ha sido
llamada.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
batchTotalCorrect = 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>let
batchTotalQuestions = 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
areasToWorkOn = [];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>for (const
key in quizSessionData) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
data = quizSessionData[key];<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>batchTotalCorrect
+= data.correct;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>batchTotalQuestions += data.total;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>if
(data.total &gt; 0 &amp;&amp; (data.correct / data.total) &lt; 0.6) { //
Threshold for &quot;needs work&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const [chordTypeKey, intervalName] = key.split('_');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const chordName = chordStructures[chordTypeKey] ?
chordStructures[chordTypeKey].name : chordTypeKey;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>areasToWorkOn.push(`Acordes ${chordName} cuando la ${intervalName} es la
nota dada.`);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
batchPercentage = batchTotalQuestions &gt; 0 ? ((batchTotalCorrect /
batchTotalQuestions) * 100).toFixed(0) : 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>evaluationSummary.innerHTML = `En las últimas
${QUESTIONS_PER_EVALUATION} preguntas: **${batchTotalCorrect} de
${batchTotalQuestions}** correctas (${batchPercentage}%).`;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>adviceList.innerHTML = ''; // Clear previous advice<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>if
(areasToWorkOn.length &gt; 0) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>areasToWorkOn.forEach(advice =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>const listItem = document.createElement('li');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>listItem.textContent = advice;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>adviceList.appendChild(listItem);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>const
listItem = document.createElement('li');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>             </span>listItem.textContent =
&quot;¡Excelente trabajo en este bloque! Sigue así.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                   
</span>adviceList.appendChild(listItem);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>evaluationModalOverlay.classList.add('visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;displayEvaluation: Clase 'visible' añadida al modal de
evaluación.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Continues
the quiz after evaluation.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
continueQuiz() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;continueQuiz: Continuing quiz.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>questionsAnsweredCount = 0; // Reset batch counter<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>quizSessionData = {}; // Reset performance data for the new batch<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>evaluationModalOverlay.classList.remove('visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>generateComplexQuestion(); // Generate a new question to start the next
batch<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>/**<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>* Ends the
quiz and displays final results.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>         </span>*/<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>function
endQuiz() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;endQuiz: Ending quiz.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>evaluationModalOverlay.classList.remove('visible');<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>quizContainer.style.display = 'none'; // Hide the main quiz UI<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const
overallPercentage = totalQuestionsAttempted &gt; 0 ? ((totalCorrectAnswers /
totalQuestionsAttempted) * 100).toFixed(0) : 0;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>finalResultsSummary.innerHTML = `Has respondido un total de
**${totalQuestionsAttempted}** preguntas, con **${totalCorrectAnswers}**
correctas (${overallPercentage}% de precisión).`;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Prepare
email link<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>           </span>const subject =
encodeURIComponent(&quot;Resultados de tu Quiz de Acordes&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>const body
= encodeURIComponent(<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>`Hola,\n\nAquí están los resultados de tu Herramienta de
Armonización:\n\n` +<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>`Total
de preguntas intentadas: ${totalQuestionsAttempted}\n` +<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>`Respuestas correctas: ${totalCorrectAnswers}\n` +<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>`Porcentaje de precisión: ${overallPercentage}%\n\n` +<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>`¡Sigue practicando!`<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>mailtoLink.href
= `mailto:?subject=${subject}&amp;body=${body}`;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>finalMessageDisplay.style.display = 'flex'; // Show the final message<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;endQuiz: Final message displayed.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Event
Listeners<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>confirmAnswerButton.addEventListener('click', checkAnswer);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>clearAllSelectionButton.addEventListener('click', clearSelection);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>changeQuestionButton.addEventListener('click', handleChangeQuestion);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>continueQuizButton.addEventListener('click', continueQuiz);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>endQuizButton.addEventListener('click', endQuiz);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>playChordButton.addEventListener('click', playChord); // Event listener
for audio playback button<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>       
</span>startButton.addEventListener('click', async () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;startButton: Clicked. Hiding intro and showing quiz
container.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>introScreen.style.display = 'none'; // Hide intro screen immediately<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>quizContainer.style.display = 'flex'; // Show quiz container immediately<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;startButton: UI transition complete.&quot;);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>//
Initialize the quiz elements<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;startButton: Initializing quiz components...&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>generateNoteButtons(); // Generate note buttons on load<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>generateVirtualKeyboard(); // Generate virtual keyboard on load<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>generateComplexQuestion(); // This includes drawing staff and updating
displays<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.log(&quot;startButton: Quiz components initialized
successfully.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>} catch
(error) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>console.error(&quot;startButton: Error during quiz component
initialization:&quot;, error);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>chordQuestionTextDiv.innerHTML = &quot;¡Error al cargar la aplicación!
Revisa la consola del navegador.&quot;;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>disableQuizInteraction();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>                </span>//
Show a custom message box instead of alert()<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>               
</span>showCustomMessage(&quot;Error de Carga&quot;, &quot;Hubo un problema al
inicializar la aplicación. Por favor, revisa la consola del navegador para más
detalles.&quot;, &quot;error&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>// Start
audio context after initial UI is loaded<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;startButton: Attempting to start audio
context.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>            </span>await
startAudioContext();<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;startButton: Audio context start attempt
completed.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>// Show intro
screen on initial load<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>window.onload
= function() {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;window.onload: Window loaded. Initializing intro
screen.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>introScreen.style.display = 'flex';<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>quizContainer.style.display = 'none'; // Ensure quiz is hidden initially<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>playChordButton.disabled = true; // Disable playback button until audio
is ready<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>           
</span>console.log(&quot;window.onload: Intro screen displayed, quiz hidden,
play button disabled.&quot;);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>        </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>    </span>&lt;/script&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/body&gt;<o:p></o:p></p>

<p class=MsoNormal>&lt;/html&gt;</p>

</div>

</body>

</html>
